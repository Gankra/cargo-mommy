<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js oranda-light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Releasing - cargo-mommy</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">
        <link rel="stylesheet" href="../oranda-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "oranda-light" : "oranda-light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('orandamdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('orandamdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('orandamdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('oranda-light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../customize/index.html"><strong aria-hidden="true">2.</strong> Customizing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../customize/roles-and-pronouns.html"><strong aria-hidden="true">2.1.</strong> Roles And Pronouns</a></li><li class="chapter-item expanded "><a href="../customize/moods.html"><strong aria-hidden="true">2.2.</strong> Moods</a></li><li class="chapter-item expanded "><a href="../customize/true-roles.html"><strong aria-hidden="true">2.3.</strong> True Roles</a></li><li class="chapter-item expanded "><a href="../customize/not-just-cargo.html"><strong aria-hidden="true">2.4.</strong> Not Just Cargo</a></li><li class="chapter-item expanded "><a href="../customize/nsfw.html"><strong aria-hidden="true">2.5.</strong> NSFW Features</a></li><li class="chapter-item expanded "><a href="../customize/never-nsfw.html"><strong aria-hidden="true">2.6.</strong> Removing NSFW Features</a></li></ol></li><li class="chapter-item expanded "><a href="../guides/index.html"><strong aria-hidden="true">3.</strong> Guides</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../guides/powershell.html"><strong aria-hidden="true">3.1.</strong> Powershell (Windows)</a></li><li class="chapter-item expanded "><a href="../guides/bash.html"><strong aria-hidden="true">3.2.</strong> Bash</a></li><li class="chapter-item expanded "><a href="../guides/ci.html"><strong aria-hidden="true">3.3.</strong> CI</a></li></ol></li><li class="chapter-item expanded "><a href="../contributing/index.html"><strong aria-hidden="true">4.</strong> Contributing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../contributing/concepts.html"><strong aria-hidden="true">4.1.</strong> Concepts</a></li><li class="chapter-item expanded "><a href="../contributing/adding-messages.html"><strong aria-hidden="true">4.2.</strong> Adding New Messages</a></li><li class="chapter-item expanded "><a href="../contributing/adding-variables.html"><strong aria-hidden="true">4.3.</strong> Adding A New Variable</a></li><li class="chapter-item expanded "><a href="../contributing/adding-moods.html"><strong aria-hidden="true">4.4.</strong> Adding A New Mood</a></li><li class="chapter-item expanded "><a href="../contributing/docs.html"><strong aria-hidden="true">4.5.</strong> Locally Building The Website</a></li><li class="chapter-item expanded "><a href="../contributing/releasing.html" class="active"><strong aria-hidden="true">4.6.</strong> Releasing</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="oranda-light">Axo Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="oranda-dark">Axo Dark</button></li>

                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">cargo-mommy</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="releasing"><a class="header" href="#releasing">Releasing</a></h1>
<p>Mommy's release process is simple but does a lot~</p>
<h2 id="cutting-a-release"><a class="header" href="#cutting-a-release">Cutting a Release</a></h2>
<ol>
<li>Checkout main</li>
<li>pull</li>
<li>Update the "Unreleased" section of <a href="https://github.com/Gankra/cargo-mommy/blob/main/CHANGELOG.md">CHANGELOG.md</a> (DO NOT CHANGE THE HEADING!)</li>
<li>Commit</li>
<li>Run <code>cargo release {version}</code> (e.g. <code>cargo release 1.0.0</code>)</li>
</ol>
<p>This will trigger this cascade of events:</p>
<ol>
<li><a href="https://github.com/crate-ci/cargo-release">cargo-release</a> will get the ball rolling:
<ol>
<li><a href="https://github.com/Gankra/cargo-mommy/blob/0d96506db241003166e32deb22ad0ab0fc52c16c/Cargo.toml#L50-L53">the changelog heading will be updated to "Version {version} ({date})"</a></li>
<li>the version in the Cargo.toml will be update to "{version}"</li>
<li><a href="https://github.com/Gankra/cargo-mommy/blob/0d96506db241003166e32deb22ad0ab0fc52c16c/Cargo.toml#L30">a commit will be made with "release: {version}"</a></li>
<li><a href="https://github.com/Gankra/cargo-mommy/blob/0d96506db241003166e32deb22ad0ab0fc52c16c/Cargo.toml#L29">a "v{version}" git tag will be created</a></li>
<li><code>cargo publish</code> will be run</li>
<li>A more robust equivalent of <code>git push &amp;&amp; git push --tags</code> will run</li>
</ol>
</li>
<li><a href="https://opensource.axo.dev/cargo-dist/">cargo-dist</a> will see the tagged commit and build binaries/archives/installers/announcements:
<ol>
<li><a href="https://github.com/Gankra/cargo-mommy/blob/main/.github/workflows/release.yml">release.yml</a> will spawn</li>
<li>binaries and archives (zips/tarballs) will get built for <a href="https://github.com/Gankra/cargo-mommy/blob/0d96506db241003166e32deb22ad0ab0fc52c16c/Cargo.toml#L41">all supported targets</a></li>
<li><a href="https://github.com/Gankra/cargo-mommy/blob/0d96506db241003166e32deb22ad0ab0fc52c16c/Cargo.toml#L39">installers will be built</a> that can fetch the archives</li>
<li>A <a href="https://github.com/Gankra/cargo-mommy/releases">Github Release</a> will be made, with the release notes and installers/archives</li>
</ol>
</li>
<li><a href="https://opensource.axo.dev/oranda/">oranda</a> will see a workflow called "Release" completed, and build and deploy docs
<ol>
<li><a href="https://github.com/Gankra/cargo-mommy/blob/main/.github/workflows/web.yml">web.yml</a> will spawn</li>
<li><a href="https://opensource.axo.dev/oranda/book/configuration/mdbook.html">oranda will autodetect, retheme, and build</a> the <a href="https://github.com/Gankra/cargo-mommy/tree/main/src">cargo-mommy mdbook</a></li>
<li>oranda will generate <a href="https://faultlore.com/cargo-mommy/">a website with releases, the book, and a platform-autodetecting install widget for the latest release</a></li>
<li>oranda will push the website to <a href="https://github.com/Gankra/cargo-mommy/tree/gh-pages">the gh-pages branch</a></li>
</ol>
</li>
<li>Github Pages will trigger
<ol>
<li><a href="https://github.com/Gankra/cargo-mommy/actions/workflows/pages/pages-build-deployment">pages-build-deployment</a> will spawn</li>
<li><a href="https://faultlore.com/cargo-mommy/">the live website will update</a></li>
</ol>
</li>
</ol>
<p>Note that steps 3 and 4 trigger on all pushes to main, so updating docs doesn't require a new release~</p>
<h2 id="updating-the-release-process"><a class="header" href="#updating-the-release-process">Updating The Release Process</a></h2>
<p>The cargo-release step was created by hand-copying some config values that Gankra likes to use in her projects. There shouldn't be any need to mess with it.</p>
<p>The cargo-dist step was created by locally running <code>cargo dist init</code>, selecting some targets/installers in the interactive prompts, and committing the results. It can be updated by running <code>cargo dist init</code> again.</p>
<p>The oranda step was created by running <code>oranda generate ci</code>, selecting some of the options, and committing the results. A <a href="https://github.com/Gankra/cargo-mommy/blob/main/oranda.json">custom oranda.json</a> was then added to fix path-prefix with github-pages, and to pick a non-default theme. The CI is setup to always use the "latest" oranda, so it's self-updating and may never need to be touched. Any changes that are desired will probably be changes to oranda.json.</p>
<p>The Github Pages step was done in the Github Settings UI for the cargo-mommy repo. The website it deploys to is Gankra's.</p>
<h2 id="ensuring-the-release-process-works"><a class="header" href="#ensuring-the-release-process-works">Ensuring The Release Process Works</a></h2>
<p>All pull requests run the <code>cargo dist plan</code> <a href="https://github.com/Gankra/cargo-mommy/blob/main/.github/workflows/release.yml">part of the releases ci</a> to check that the release process still works.</p>
<p>All pull requests run the <code>oranda build</code> <a href="https://github.com/Gankra/cargo-mommy/blob/main/.github/workflows/web.yml">part of the website ci</a> to check that the website and mdbook still works.</p>
<p>(This is just the default behaviour of the CI scripts that cargo-dist and oranda generate!)</p>
<h2 id="historical-releases"><a class="header" href="#historical-releases">Historical Releases</a></h2>
<p>This process was setup for 0.3.0, everything before that was Gankra being intentionally sloppy because all of the above is her actual job and sometimes you just don't want to think about work and just want to mash <code>cargo publish</code> and nothing more on your shitpost that everyone took way too seriously.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../contributing/docs.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../contributing/docs.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
